<!doctype html>
<html lang="en">
	<head>
        <title>Socket.IO chat</title>
        <style>
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body { font: 13px Helvetica, Arial; }
            form { background: #000; padding: 3px; position: fixed; bottom: 0; width: 100%; }
            form input { border: 0; padding: 10px; width: 90%; margin-right: .5%; }
            form button { width: 9%; background: lightslategray; border: none; padding: 10px; }
            #messages { list-style-type: none; margin: 0; padding: 0; }
            #messages li { padding: 5px 10px; }
            #messages li:nth-child(odd) { background: #eee; }
        </style>
    </head>
    <body>
        <h3 id="startOfQuiz"></h3>
        <p id="display"></p>
        <br />
        <h3 id="countdownTitle"></h3>
        <p id="demo"></p>

        <ul id="messages"></ul>
        <form action="">
        <input id="m" autocomplete="off" /><button>Send</button>
        </form>

     	<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="/socket.io/socket.io.js"></script>   
        
        <script>
            var socket = io();

            socket.on('startOfQuiz', function(date) {
                $('#startOfQuiz').html('Start time of quiz: ');

                var time = new Date(date);
                document.getElementById("display").innerHTML = time;

                // Update the count down every 1 second
                var x = setInterval(function() {

                    // Get todays date and time
                    var now = new Date().getTime();

                    // Find the distance between now and the count down date
                    var distance = date - now;

                    // Time calculations for days, hours, minutes and seconds
                    var days = Math.floor(distance / (1000 * 60 * 60 * 24));
                    var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                    var seconds = Math.floor((distance % (1000 * 60)) / 1000);

                    document.getElementById("countdownTitle").innerHTML = "Amount of time until quiz: ";

                    // Output the result in an element with id="demo"
                    document.getElementById("demo").innerHTML = days + "d " + hours + "h "
                    + minutes + "m " + seconds + "s ";

                    // If the count down is over, write some text 
                    if (distance <= 0) {
                        clearInterval(x);
                        questionCountdown();
                    }
                }, 1000);
            });

            function questionCountdown() {
                document.getElementById("countdownTitle").innerHTML = "Time remaining to answer question : ";
                var timeLeft = 30;
                var questionTimer = setInterval(function() {
                    if (timeLeft == 0){
                        document.getElementById("demo").innerHTML = "Time's up!";
                    } else {
                        document.getElementById("demo").innerHTML = timeLeft + ' seconds remaining';
                        timeLeft--;
                    }
                }, 1000);
            }

            $(function () {
                $('form').submit(function(e){
                    e.preventDefault();
                    var message = $('#m').val();
                    socket.emit('chat message', message);
                    return false;
                });
                socket.on('chat message', function(msg){
                    $('#messages').append($('<li>').text(msg));
                    var d = new Date();
                    $('#messages').append($('<li>').text(d));
                });
            });
        </script>
            
    </body>
</html>